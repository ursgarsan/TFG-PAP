extends ../layout

block content
  h1= title

  form(id="grupoForm", action="/grupos/create", method="POST")
    label(for="tipo") Tipo:
    input(type="text", id="tipo", name="tipo", class="form-control", value= data.tipo ? data.tipo : "")
    br
    if errors && errors.tipo
      p.error-message= errors.tipo.msg

    label(for="grupo") Grupo:
    input(type="text", id="grupo", name="grupo", class="form-control", value= data.grupo ? data.grupo : "")
    br
    if errors && errors.grupo
      p.error-message= errors.grupo.msg

    label(for="cuatrimestre") Cuatrimestre:
    input(type="text", id="cuatrimestre", name="cuatrimestre", class="form-control", value= data.cuatrimestre ? data.cuatrimestre : "")
    br
    if errors && errors.cuatrimestre
      p.error-message= errors.cuatrimestre.msg

    label(for="acreditacion") Acreditación:
    input(type="text", id="acreditacion", name="acreditacion", class="form-control", value= data.acreditacion ? data.acreditacion : "")
    br
    if errors && errors.acreditacion
      p.error-message= errors.acreditacion.msg

    label(for="curso") Curso:
    input(type="text", id="curso", name="curso", class="form-control", value= data.curso ? data.curso : "")
    br
    if errors && errors.curso
      p.error-message= errors.curso.msg

    label(for="asignatura_id") Asignatura:
    select(id="asignatura_id", name="asignatura_id", class="form-select")
      each asignatura in asignaturas
        option(value=asignatura._id)= asignatura.nombre
    br
    if errors && errors.asignatura_id
      p.error-message= errors.asignatura_id.msg

    #horarioContainer
      .horarioEntry
        each day in ['Lunes', 'Martes', 'Miércoles', 'Jueves', 'Viernes']
          input(type="checkbox", id=`horario_${day.toLowerCase()}`, name=`horario[0][dias]`, value=day)
          label(for=`horario_${day.toLowerCase()}`)= day
          br
        label(for="hora_inicio") Hora de inicio:
        input(type="text", id="hora_inicio", name="horario[0][hora_inicio]", class="form-control", value= data.horario ? (data.horario[0] ? data.horario[0].hora_inicio : "") : "")
        br
        if errors && errors['horario[0][hora_inicio]']
          p.error-message= errors['horario[0][hora_inicio]'].msg

        label(for="hora_fin") Hora de fin:
        input(type="text", id="hora_fin", name="horario[0][hora_fin]", class="form-control", value= data.horario ? (data.horario[0] ? data.horario[0].hora_fin : "") : "")
        br
        if errors && errors['horario[0][hora_fin]']
          p.error-message= errors['horario[0][hora_fin]'].msg

    button(type="button", id="agregarHorario", class="btn btn-primary") Agregar Horario

    button(type="submit", class="btn btn-primary") Crear Grupo

  script.
    document.getElementById('agregarHorario').addEventListener('click', function() {
      var horarioContainer = document.getElementById('horarioContainer');
      var numHorarios = document.querySelectorAll('.horarioEntry').length;

      var newHorarioEntry = document.createElement('div');
      newHorarioEntry.classList.add('horarioEntry');

      ['Lunes', 'Martes', 'Miércoles', 'Jueves', 'Viernes'].forEach(function(day) {
        var checkbox = document.createElement('input');
        checkbox.type = 'checkbox';
        checkbox.id = 'horario_' + day.toLowerCase();
        checkbox.name = `horario[${numHorarios}][dias]`;
        checkbox.value = day;

        var label = document.createElement('label');
        label.htmlFor = 'horario_' + day.toLowerCase();
        label.textContent = day;

        newHorarioEntry.appendChild(checkbox);
        newHorarioEntry.appendChild(label);
        newHorarioEntry.appendChild(document.createElement('br'));
      });

      var horaInicioLabel = document.createElement('label');
      horaInicioLabel.htmlFor = 'hora_inicio';
      horaInicioLabel.textContent = 'Hora de inicio:';
      newHorarioEntry.appendChild(horaInicioLabel);

      var horaInicioInput = document.createElement('input');
      horaInicioInput.type = 'text';
      horaInicioInput.id = 'hora_inicio';
      horaInicioInput.name = `horario[${numHorarios}][hora_inicio]`;
      horaInicioInput.classList.add('form-control');
      horaInicioInput.required = true;
      newHorarioEntry.appendChild(horaInicioInput);
      newHorarioEntry.appendChild(document.createElement('br'));

      var horaFinLabel = document.createElement('label');
      horaFinLabel.htmlFor = 'hora_fin';
      horaFinLabel.textContent = 'Hora de fin:';
      newHorarioEntry.appendChild(horaFinLabel);

      var horaFinInput = document.createElement('input');
      horaFinInput.type = 'text';
      horaFinInput.id = 'hora_fin';
      horaFinInput.name = `horario[${numHorarios}][hora_fin]`;
      horaFinInput.classList.add('form-control');
      horaFinInput.required = true;
      newHorarioEntry.appendChild(horaFinInput);
      newHorarioEntry.appendChild(document.createElement('br'));

      horarioContainer.appendChild(newHorarioEntry);
    });
